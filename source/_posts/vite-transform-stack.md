---
title: vite-transform-stack
date: 2024-04-03 15:32:36
tags:
---
Vite 使用插件系统处理文件转换和优化。这个插件系统中的工作流程将调用的所有插件组成一个处理栈，被称为 “Transform Stack”。

Transform Stack 执行过程如下：

1. 当一个文件被请求时，Vite 将会通过路径和查询参数找到对应文件，并判断其类型。

2. 依据文件类型，Vite 将会按照一定顺序应用在 Transform Stack 里注册的插件对文件进行处理，比如将 TypeScript 或 Vue 单文件组件转换成 JavaScript。

3. 如果一个插件在处理文件的过程中又引入了其他文件，Vite 将会重新走一遍这个过程，直到所有相关的文件都被转换并最终合并成一份能在浏览器中运行的代码。

有了 Transform Stack，Vite 可以通过管理不同类型的插件，为开发者提供一种灵活的方式来满足自定的转换需求。比如，你可以使用已经存在的插件，如 Vite 的官方插件或第三方插件，也可以根据自己的需要创建自定义插件。


### transform stack - 概念
"Transform Stack"是一个计算机图形学中的概念，主要用在向量或图形等元素的转换（变换）操作中。变换操作可以包括旋转，缩放，反射和平移这样的基础操作，也可以是这些操作的复合。

"Transform Stack"像是一个数据栈，它能保存一系列的变换矩阵。一般来说，有三种主要的操作：

1. Push：将当前变换矩阵压入栈顶。
2. Pop：从栈顶取出一个变换矩阵，并将它设为当前的变换矩阵。
3. 末尾或顶部添加新的变换：通常这是以一种预乘或后乘的方式，在变换矩阵的末尾或顶部添加新的变换。

这个机制的好处是，你可以很容易地保存和恢复之前的变换状态。例如，在一次复杂的变换操作中，你可能会经历多次旋转和平移，但在这之后，你可能又需要回到某一个早期的状态。借助于"Transform Stack"，你可以在需要的时候将之前的状态"弹出"，而不必手动去计算如何回到那个状态。