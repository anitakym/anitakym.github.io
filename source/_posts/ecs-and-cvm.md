---
title: ecs-and-cvm
date: 2021-10-06 13:52:27
tags:
---
> 17年到现在，团队在阿里云和腾讯云之间切换了几回（各种原因），现对于使用过的产品做下梳理；

# 阿里云

## 网络与CDN - 负载均衡
### 文档
- https://help.aliyun.com/document_detail/196874.html
- 

### TIPS
- 计费 ｜ 可用区（单｜多）

## 云服务器 - ECS
### 文档

### Basic
- Elastic Compute Service
- 基于虚拟化资源池
- 多线BGP
  - border gateway protocol 边界网关协议 - 配置在路由上
  - 三网（跨运营商）
  - 解决不同网络之间的差异
  - 动态｜静态BGP - https://developer.aliyun.com/article/179417
- 专线

#### 创建
- 地域 - 可用区
- “不同地域的实例之间内网互不相通；选择靠近您客户的地域，可降低网络时延、提高您客户的访问速度”
- 用户所在地 
- 相关别的产品也买在相同可用区
- 数据备份，冗余，异地多活


## 控制台Tips
- APP｜Web
- Web全功能，也在不断改进体验 - console域下
- 善用站点提供的搜索功能
- 公司账号 - 费用和工单 - 按量计费｜包年包月
- 腾讯云我们是比较大的用户，会有专门的客服QQ群，回复还是非常及时的（不同支持时效收费也不一样，和每年消费的额度到达某个额度也相关，各部分服务的折扣也和消费额度相关）

## ECS节点选择
- 目标用户所在地
- 购买的各种服务之间注意关系
- 数据冗余

## 选型
- 公网带宽（注意根据需求计算）
- 会本身有类型分类，根据指引选择 - 个人
- 企业有定制的
## VPC
- 经典网络 - 所有ECS直接建立在传统网络层之上
- VPC - 加入逻辑隔离私有网络 - 安全性提升
- VPC - natGateway|Router|Switch - 自定义
- 企业网络 - 需要接入专线到XX云机房 - VPC提供了可能

## EIP
- eth0 内网IP eth1 公网IP
- 弹性公网IP ｜ ECS公网IP - 和实例绑定在一起的
- 弹性公网IP - 支持在ECS上面弹性绑定和解绑
- ECS ｜ EIP - 关系
- 弹性公网IP支持的协议 - TCP｜UDP｜ICMP

## ECS弹性网卡
- 随时可以实现分离的虚拟网卡
- vCPU >= 4
- 适合搭建高可用集群
- 低成本故障转移
- 精细化网络管理
- 不同配置支持的可增加的弹性网卡的数量不一样

## NAT网关
- 公司采用的就是这种
- 具体可见腾讯云文档
- 不用每一个服务器，绑定一个vpc公网；通过统一得公网地址做限制策略，便于管理，也比每一个公网地址绑定省钱 
## ECS配置
- 密钥对 ｜ 密码
- 密钥对生成 - ssh-keygen - 公钥配置到服务器
- 登录 ssh -i ~/.ssh/id_rsa root@xxx.xxx.xxx.xxx
- 如果ssh登录有问题，可以通过远程连接

## ECS快照
- 手动 ｜ 自动
- 增量快照机制（第一次快照全量，后续增量）
- 快照会影响磁盘I/O - 所以处理场景和时机要把握好
- 自动快照执行前清理不必要数据 - 定时任务清理日志等
- 快照OSS资源包 - 容量选择 - 看下Used大小
- 备份周期

## ECS镜像
- 镜像源快速生成ECS实例
- 创建自定义镜像
- 快照可以生成自定义镜像

# 腾讯云

### NAT
- https://cloud.tencent.com/document/product/552/12951
# 其他

## Tengine
- 配置nginx的时候走这个
- http://tengine.taobao.org/

