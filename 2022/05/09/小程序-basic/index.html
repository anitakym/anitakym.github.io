<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="ImaginingMe">
    <meta name="keyword"  content="frontend">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        小程序-basic - 前端技术分享 | AnitaK&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 5.0.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> DICHTEN == CONDENSARE </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="http://www.imaginingme.cn/img/avatar.jpeg" />
        </div>
        <div class="name">
            <i>ImaginingMe</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A5%E6%BA%90"><span class="toc-text">来源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83"><span class="toc-text">运行环境</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7"><span class="toc-text">开发工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1"><span class="toc-text">路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%EF%BD%9C%E6%8E%A5%E5%8F%A3"><span class="toc-text">组件｜接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6"><span class="toc-text">运行机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E7%BA%BF%E7%A8%8B%E6%9E%B6%E6%9E%84"><span class="toc-text">双线程架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#setData"><span class="toc-text">setData</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ios"><span class="toc-text">ios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wxs"><span class="toc-text">wxs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%BA%BF%E7%A8%8B"><span class="toc-text">视图线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E7%BA%BF%E7%A8%8B"><span class="toc-text">逻辑线程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wxss"><span class="toc-text">wxss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6"><span class="toc-text">事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tap"><span class="toc-text">tap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-text">组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#icon%E7%BB%84%E4%BB%B6"><span class="toc-text">icon组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6"><span class="toc-text">自定义组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#notes"><span class="toc-text">notes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%B8%85%E9%99%A4web%E7%BC%93%E5%AD%98"><span class="toc-text">微信清除web缓存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%BF%E4%B8%BB%E7%8E%AF%E5%A2%83-%E6%B8%B2%E6%9F%93%E5%B1%82%E5%92%8C%E9%80%BB%E8%BE%91%E5%B1%82"><span class="toc-text">小程序宿主环境 - 渲染层和逻辑层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86"><span class="toc-text">设计原理</span></a>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> DICHTEN == CONDENSARE </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        小程序-basic
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2022-05-09 22:52:28</span></span>
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h4 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h4><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">​微信面临的问题是如何设计一个比较好的系统，使得所有开发者在微信中都能获得比较好的体验。这个问题是之前的 JS-SDK 所处理不了的，需要一个全新的系统来完成，它需要使得所有的开发者都能做到：</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>快速的加载</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>更强大的能力</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>原生的体验</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>易用且安全的微信数据开放</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>高效和简单的开发</span><br><span class="line"></span><br><span class="line">这就是小程序的由来。</span><br></pre></td></tr></table></figure>
<h4 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">表<span class="number">1</span><span class="number">-1</span> 小程序的运行环境</span><br><span class="line"></span><br><span class="line">运行环境    逻辑层    渲染层</span><br><span class="line">iOS    JavaScriptCore    WKWebView</span><br><span class="line">安卓    V8    chromium定制内核</span><br><span class="line">小程序开发者工具    NWJS    Chrome WebView</span><br></pre></td></tr></table></figure>

<h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><ul>
<li>代码提示</li>
<li>设置 - 编辑设置</li>
<li>真机调试 - 发给第三方（用户）</li>
<li>预览 - 自己用</li>
<li>详情 - 本地设置 - 看基本库版本</li>
</ul>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><ul>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html">https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html</a></li>
</ul>
<h3 id="组件｜接口"><a href="#组件｜接口" class="headerlink" title="组件｜接口"></a>组件｜接口</h3><ul>
<li>设计的边界</li>
</ul>
<h2 id="运行机制"><a href="#运行机制" class="headerlink" title="运行机制"></a>运行机制</h2><ul>
<li>热启动｜冷启动 - 缓存｜getupdateManager </li>
<li>主动销毁 - 内存警告｜进入后台一定时间</li>
<li>前台状态｜后台状态</li>
</ul>
<h3 id="双线程架构"><a href="#双线程架构" class="headerlink" title="双线程架构"></a>双线程架构</h3><ul>
<li>why - 安全+管控</li>
<li>View - 视图线程 &amp;&amp; App Service - 逻辑线程</li>
<li>View | App Service | Native</li>
<li>view - Page(WXML|WXSS)</li>
<li>App Sevice - Manager | API</li>
<li>Native - 微信能力｜离线存储｜网络请求｜JSBridge</li>
<li>Event | Data</li>
</ul>
<h4 id="setData"><a href="#setData" class="headerlink" title="setData"></a>setData</h4><ul>
<li>evaluateJavaScript实现的(hybrid也是)</li>
<li>（安卓）可能页面卡顿（界面滑动中 - 视图线程 - 渲染中）是由evaluateJavaScript导致的</li>
<li>逻辑层发来的请求阻塞了，阻塞超过200MS就会有卡顿的感觉<h4 id="ios"><a href="#ios" class="headerlink" title="ios"></a>ios</h4></li>
<li>wkwebview - 内存紧张，wkwebview会被回收，所以一些历史页面我们回不去</li>
</ul>
<h4 id="wxs"><a href="#wxs" class="headerlink" title="wxs"></a>wxs</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/64732764/answer/316980141">https://www.zhihu.com/question/64732764/answer/316980141</a></li>
<li>wxs不依赖于运行时的基础库版本 - 可以在所有小程序版本里面运行</li>
<li>运行在View线程里</li>
<li>提高View层运行效率</li>
<li>运行环境和其他JS代码是隔离的</li>
<li>IOS上效率高，android上面和JS没啥差别</li>
<li>应用场景 - 如何提高效率</li>
</ul>
<h4 id="视图线程"><a href="#视图线程" class="headerlink" title="视图线程"></a>视图线程</h4><ul>
<li>编译原理</li>
<li>小程序视图层是在polymer基础上，基于web component 标准实现的</li>
<li>类似Vue的实现</li>
<li>原生在vw上面</li>
<li>生命周期</li>
</ul>
<h4 id="逻辑线程"><a href="#逻辑线程" class="headerlink" title="逻辑线程"></a>逻辑线程</h4><ul>
<li>初始化｜等待激活｜激活｜后台运行 - 四个状态</li>
</ul>
<h2 id="wxss"><a href="#wxss" class="headerlink" title="wxss"></a>wxss</h2><ul>
<li>选择器，不断发展中</li>
<li>rpx</li>
<li>字体配置跟着系统走</li>
<li>小程序 app.wxss可以设置全局样式 - 字体等 - <code>page &#123; font-family: &quot;xxx&quot; &#125;</code></li>
<li>全局样式表里面设置的样式 - 可以被组件继承的 - font|color (见官方文档)</li>
<li>页面和组件的概念要分清楚</li>
<li>文件间距可以用line-height消除空白</li>
</ul>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="tap"><a href="#tap" class="headerlink" title="tap"></a>tap</h3><ul>
<li>bind:tap 一般不阻止点击事件的冒泡</li>
<li>catch:tap</li>
</ul>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><h3 id="icon组件"><a href="#icon组件" class="headerlink" title="icon组件"></a>icon组件</h3><h3 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h3><h2 id="notes"><a href="#notes" class="headerlink" title="notes"></a>notes</h2><ul>
<li>支付框不会触发App的onHide</li>
<li>转发和分享到朋友圈会执行App的onHide</li>
</ul>
<h2 id="微信清除web缓存"><a href="#微信清除web缓存" class="headerlink" title="微信清除web缓存"></a>微信清除web缓存</h2><ul>
<li>Android<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">按提示来就行，如果不支持切换X5内核，此方法不通</span><br><span class="line"><span class="number">1.</span>http:<span class="comment">//debugx5.qq.com</span></span><br><span class="line"><span class="number">2.</span>http:<span class="comment">//debugtbs.qq.com/</span></span><br><span class="line"><span class="number">3.</span>debugmm.qq.com/?forcex5=<span class="literal">true</span> </span><br><span class="line"></span><br><span class="line">我的 - 微信</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="小程序宿主环境-渲染层和逻辑层"><a href="#小程序宿主环境-渲染层和逻辑层" class="headerlink" title="小程序宿主环境 - 渲染层和逻辑层"></a>小程序宿主环境 - 渲染层和逻辑层</h2><ul>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/framework.html#%E6%B8%B2%E6%9F%93%E5%B1%82%E5%92%8C%E9%80%BB%E8%BE%91%E5%B1%82">https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/framework.html#%E6%B8%B2%E6%9F%93%E5%B1%82%E5%92%8C%E9%80%BB%E8%BE%91%E5%B1%82</a></li>
</ul>
<h3 id="设计原理"><a href="#设计原理" class="headerlink" title="设计原理"></a>设计原理</h3><ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903669389852685">https://juejin.cn/post/6844903669389852685</a></li>
</ul>

        
            <div class="donate-container">
    <div class="donate-button">
        <button id="donate-button">赞赏</button>
    </div>
    <div class="donate-img-container hide" id="donate-img-container">
        <img id="donate-img" src="" data-src="img/donate.jpg">
        <p> 感谢鼓励 </p>
    </div>
</div>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        
        <li>
            <a target="_blank"  href="https://github.com/anitakym">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><p>京ICP备19049908号-1</p></a>
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
